{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\user\\\\Desktop\\\\Shaji Project\\\\frontEnd\\\\src\\\\core\\\\Cod.js\";\nimport React, { useState, useEffect } from 'react';\nimport \"./Bill.css\";\nimport { v4 as uuidv4 } from 'uuid';\nimport { loadCart, loadCartBill, findQty } from './helper/cartHelper';\nimport { isAutheticated } from \"../auth/helper/index\";\nimport { confirmOrders } from './helper/coreapicalls';\nimport { Redirect } from 'react-router-dom';\nimport { getUserAddress } from \"./helper/locationhelper\";\nimport { getAllDataOfUser } from '../user/helper/userapicalls';\nexport default function Cod() {\n  const [cartproducts, setcartproducts] = useState([]);\n  const [reload, setReload] = useState(false);\n  const [totalcount, setTotalcount] = useState(0);\n  const [redireact, setredireact] = useState(false);\n  const [totalPrice, setTotalPrice] = useState(0);\n  const [loading, setLoading] = useState(false);\n  const [thisProduct, setthisProduct] = useState(0);\n  const [thisNameProducts, setthisNameProducts] = useState(0);\n  const [userids, setuserids] = useState(\"\");\n  const [useraddress, setuseraddress] = useState(\"\");\n  const [usercoord, setusercoord] = useState([]);\n\n  const showUserDelAddres = () => {\n    if (useraddress && usercoord) {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        class: \"alert alert-light\",\n        role: \"alert\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 30,\n          columnNumber: 7\n        }\n      }, useraddress);\n    }\n  };\n\n  const loadAllUserDatas = () => {\n    if (userids != \"\") {\n      getAllDataOfUser({\n        userids\n      }).then(res => {\n        console.log(res);\n        setuseraddress(res.address);\n        setusercoord(res.coord);\n        setuserids(\"\");\n      }).catch(err => {\n        console.log(err);\n      });\n    }\n  };\n\n  useEffect(() => {\n    setcartproducts(loadCart());\n    setthisProduct(loadCartBill());\n    setthisNameProducts(loadCartBill());\n    autoCountBtn();\n    setuserids(isAutheticated().user._id);\n  }, []);\n  const [latitude, setLatitude] = useState(\"\");\n  const [longitude, setLongitude] = useState(\"\");\n  const [location, setlocation] = useState(0);\n\n  const locationUser = event => {\n    setlocation(event.target.value); //Location done\n  };\n\n  const getGLocation = () => {\n    if (navigator.geolocation) {\n      navigator.geolocation.getCurrentPosition(getCoordinates, handleLocationError);\n    } else {\n      alert(\"Geolocation is not supported by this browser.\");\n    }\n  };\n\n  const getCoordinates = position => {\n    console.log(position.coords.latitude);\n    setLatitude(position.coords.latitude);\n    console.log(position.coords.longitude);\n    setLongitude(position.coords.longitude);\n  };\n\n  const autoCountBtn = () => {\n    let cart = [];\n    let TCOUNT = 0;\n    let TOTAL_PRICE = 0;\n\n    if (typeof window !== undefined) {\n      if (localStorage.getItem(\"cart\")) {\n        cart = JSON.parse(localStorage.getItem(\"cart\"));\n      }\n\n      cart.map((PRODUCT, INDEX) => {\n        if (PRODUCT != null) {\n          TCOUNT = TCOUNT + 1;\n          TOTAL_PRICE = TOTAL_PRICE + PRODUCT.price;\n        }\n      });\n      setTotalcount(TCOUNT);\n      setTotalPrice(TOTAL_PRICE);\n      TCOUNT = 0;\n    }\n  };\n\n  const userId = isAutheticated().user;\n  const token = isAutheticated().token;\n\n  const isRedirectHome = () => {\n    if (redireact) {\n      return /*#__PURE__*/React.createElement(Redirect, {\n        to: \"/\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 16\n        }\n      });\n    }\n  };\n\n  const confirmOrder = event => {\n    event.preventDefault();\n    setLoading(true);\n    const PRODUCTS = loadCartBill();\n    console.log(\"S o \", PRODUCTS);\n    const names = contQty(PRODUCTS);\n    console.log(\"S o  names \", names);\n    const price = contPrice(PRODUCTS);\n    console.log(\"S o  price \", price);\n    localStorage.setItem(\"orderID\", uuidv4());\n    console.log(\"location : \", location);\n    console.log(\"userId : \", userId, token);\n    console.log(\"totalPrice : \", totalPrice);\n    console.log(\"cartproducts : S o \", cartproducts);\n    const ORDERID = localStorage.getItem(\"orderID\");\n    confirmOrders({\n      PRODUCTS,\n      names,\n      cartproducts,\n      price,\n      location,\n      totalPrice,\n      userId,\n      token\n    }, userId, token, ORDERID).then(responce => {\n      console.log(\"resdd . . . \", responce);\n      console.log(\"PRODUCTS : \", PRODUCTS);\n      PRODUCTS.map((pName, index) => {\n        console.log(\"pNAme\", pName);\n        window.localStorage.removeItem(pName);\n      });\n      window.localStorage.removeItem(\"cart\");\n      window.localStorage.removeItem(\"orderID\");\n      setredireact(true);\n    }).catch(err => {\n      console.log(err);\n    });\n  };\n\n  const showTheAddressBar = () => {};\n\n  const isLoading = () => {\n    if (loading) {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        class: \"spinner-border text-warning\",\n        role: \"status\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 156,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        class: \"sr-only\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 3\n        }\n      }, \"Loading...\"));\n    }\n  };\n\n  const handleLocationError = error => {\n    switch (error.code) {\n      case error.PERMISSION_DENIED:\n        alert(\"User denied the request for Geolocation.\");\n        break;\n\n      case error.POSITION_UNAVAILABLE:\n        alert(\"Location information is unavailable.\");\n        break;\n\n      case error.TIMEOUT:\n        alert(\"The request to get user location timed out.\");\n        break;\n\n      case error.UNKNOWN_ERROR:\n        alert(\"An unknown error occurred.\");\n        break;\n\n      default:\n        alert(\"An unknown error accurder type ur address manually\");\n    }\n  };\n\n  const contQty = product => {\n    let cart = [];\n    let yy = [];\n    console.log(\"--->>> y product \", product);\n    let TOTOAL = 0;\n\n    if (typeof window !== undefined) {\n      if (localStorage.getItem(\"cart\")) {\n        cart = JSON.parse(localStorage.getItem(\"cart\"));\n        product.map((pro, I) => {\n          cart.map((cpor, cI) => {\n            if (cpor != null && pro === cpor.name) {\n              TOTOAL = TOTOAL + 1;\n            }\n          });\n          yy.push(TOTOAL);\n          TOTOAL = 0;\n        });\n      }\n    }\n\n    return yy;\n  };\n\n  const contPrice = product => {\n    let cart = [];\n    let yy = [];\n    let curentProduct = [];\n    console.log(\"--->>> y product \", product);\n    let TOTOAL = 0;\n\n    if (typeof window !== undefined) {\n      if (localStorage.getItem(\"cart\")) {\n        cart = JSON.parse(localStorage.getItem(\"cart\"));\n        product.map((pro, I) => {\n          cart.map((cpor, cI) => {\n            if (cpor != null && pro === cpor.name) {\n              TOTOAL = TOTOAL + 1;\n              yy.push(cpor.price);\n            }\n          });\n          TOTOAL = 0;\n        });\n      }\n    }\n\n    curentProduct = [...new Set(yy)];\n    return curentProduct;\n  };\n\n  const shoemap = () => {\n    if (latitude && longitude) {\n      const loc = {\n        \"latitude\": latitude,\n        \"longitude\": longitude\n      };\n      getUserAddress(loc).then(res => {// console.log(res);\n      }).catch(err => {// console.log(err);\n      });\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 245,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"h1\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 247,\n      columnNumber: 13\n    }\n  }, \"COD\"), /*#__PURE__*/React.createElement(\"h4\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 248,\n      columnNumber: 5\n    }\n  }, JSON.stringify(latitude), \" \", JSON.stringify(longitude)), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 249,\n      columnNumber: 5\n    }\n  }, shoemap()), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"container codbox\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 252,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    class: \"alert alert-primary\",\n    role: \"alert\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 253,\n      columnNumber: 13\n    }\n  }, \"We are currently available in\", /*#__PURE__*/React.createElement(\"a\", {\n    href: \"#\",\n    class: \"alert-link\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 254,\n      columnNumber: 32\n    }\n  }, \" Malumichampatti\"), \". And we can do delivery !!\"), /*#__PURE__*/React.createElement(\"form\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 256,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    class: \"form-group\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 257,\n      columnNumber: 3\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 258,\n      columnNumber: 5\n    }\n  }, \"Your Address\")), isRedirectHome(), loadAllUserDatas(), showUserDelAddres(), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: confirmOrder,\n    type: \"submit\",\n    class: \"btn btn-primary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 265,\n      columnNumber: 3\n    }\n  }, \"Confirm Address\"), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: getGLocation,\n    type: \"submit\",\n    class: \"btn btn-primary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 266,\n      columnNumber: 3\n    }\n  }, \"Confirm Address\"))));\n}","map":{"version":3,"sources":["C:/Users/user/Desktop/Shaji Project/frontEnd/src/core/Cod.js"],"names":["React","useState","useEffect","v4","uuidv4","loadCart","loadCartBill","findQty","isAutheticated","confirmOrders","Redirect","getUserAddress","getAllDataOfUser","Cod","cartproducts","setcartproducts","reload","setReload","totalcount","setTotalcount","redireact","setredireact","totalPrice","setTotalPrice","loading","setLoading","thisProduct","setthisProduct","thisNameProducts","setthisNameProducts","userids","setuserids","useraddress","setuseraddress","usercoord","setusercoord","showUserDelAddres","loadAllUserDatas","then","res","console","log","address","coord","catch","err","autoCountBtn","user","_id","latitude","setLatitude","longitude","setLongitude","location","setlocation","locationUser","event","target","value","getGLocation","navigator","geolocation","getCurrentPosition","getCoordinates","handleLocationError","alert","position","coords","cart","TCOUNT","TOTAL_PRICE","window","undefined","localStorage","getItem","JSON","parse","map","PRODUCT","INDEX","price","userId","token","isRedirectHome","confirmOrder","preventDefault","PRODUCTS","names","contQty","contPrice","setItem","ORDERID","responce","pName","index","removeItem","showTheAddressBar","isLoading","error","code","PERMISSION_DENIED","POSITION_UNAVAILABLE","TIMEOUT","UNKNOWN_ERROR","product","yy","TOTOAL","pro","I","cpor","cI","name","push","curentProduct","Set","shoemap","loc","stringify"],"mappings":"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","sourcesContent":["import React,{useState,useEffect} from 'react'\r\nimport \"./Bill.css\"\r\nimport { v4 as uuidv4 } from 'uuid';\r\n\r\nimport { loadCart,loadCartBill,findQty } from './helper/cartHelper';\r\nimport { isAutheticated } from \"../auth/helper/index\";\r\nimport { confirmOrders } from './helper/coreapicalls';\r\nimport { Redirect } from 'react-router-dom';\r\nimport {getUserAddress} from \"./helper/locationhelper\"\r\nimport { getAllDataOfUser } from '../user/helper/userapicalls';\r\n\r\n\r\nexport default function Cod() {\r\n  const [cartproducts, setcartproducts] = useState([]);\r\n  const [reload, setReload] = useState(false);\r\n  const [totalcount,setTotalcount] = useState(0);\r\n  const [redireact,setredireact] = useState(false);\r\n\r\n  const [totalPrice,setTotalPrice] = useState(0); \r\n  const [loading,setLoading] = useState(false);\r\n  const [thisProduct,setthisProduct] = useState(0); \r\n  const [thisNameProducts,setthisNameProducts] = useState(0); \r\n  const [userids,setuserids] = useState(\"\"); \r\n  const [useraddress,setuseraddress] = useState(\"\"); \r\n  const [usercoord,setusercoord] = useState([]); \r\n\r\nconst showUserDelAddres  = () => {\r\n  if(useraddress && usercoord){\r\n    return(\r\n      <div class=\"alert alert-light\" role=\"alert\">\r\n        {useraddress}\r\n</div>\r\n    )\r\n  }\r\n}\r\n const loadAllUserDatas = () => {\r\n   if(userids != \"\"){\r\n     getAllDataOfUser({userids}).then(res => {\r\n       console.log(res);\r\n       setuseraddress(res.address)\r\n       setusercoord(res.coord)\r\n       setuserids(\"\")\r\n     })\r\n     .catch(err => {\r\n       console.log(err);\r\n     })\r\n   }\r\n }\r\n  useEffect(() => {\r\n    setcartproducts(loadCart());\r\n    setthisProduct(loadCartBill())\r\n    setthisNameProducts(loadCartBill());\r\n    autoCountBtn()\r\n    setuserids(isAutheticated().user._id)\r\n  \r\n  }, []);\r\n    const [latitude,setLatitude] = useState(\"\");\r\n    const [longitude,setLongitude] = useState(\"\");\r\n\r\n    const [location, setlocation] = useState(0)\r\n    const locationUser = event => {\r\n        setlocation(event.target.value) //Location done\r\n    }\r\n\r\n    const getGLocation = () => {\r\n      if (navigator.geolocation) {\r\n        navigator.geolocation.getCurrentPosition(getCoordinates,handleLocationError);\r\n      } else {\r\n        alert(\"Geolocation is not supported by this browser.\");\r\n      }\r\n    }\r\n    const getCoordinates = (position) => {\r\n      console.log(position.coords.latitude)\r\n      setLatitude(position.coords.latitude)\r\n      console.log(position.coords.longitude)\r\n      setLongitude(position.coords.longitude)\r\n\r\n    }\r\n    const autoCountBtn = () => {\r\n      let cart = [];\r\n      let TCOUNT = 0;\r\n      let TOTAL_PRICE = 0;\r\n    \r\n      if (typeof window !== undefined) {\r\n        if (localStorage.getItem(\"cart\")) {\r\n          cart = JSON.parse(localStorage.getItem(\"cart\"));\r\n        }\r\n      \r\n            cart.map((PRODUCT,INDEX)=>{\r\n              if(PRODUCT != null){\r\n                TCOUNT = TCOUNT + 1;\r\n                TOTAL_PRICE =TOTAL_PRICE + PRODUCT  .price;\r\n              }\r\n            })\r\n        setTotalcount(TCOUNT)\r\n        setTotalPrice(TOTAL_PRICE);\r\n    \r\n        TCOUNT=0\r\n        }\r\n      }\r\n    const userId = isAutheticated().user;\r\n    const token = isAutheticated().token;\r\n    const isRedirectHome = () =>{\r\n      if(redireact){\r\n        return <Redirect to=\"/\"/>\r\n      }\r\n    }\r\n    const confirmOrder = (event) => {\r\n        event.preventDefault();\r\n        setLoading(true)\r\n        const PRODUCTS  = loadCartBill();\r\n        console.log(\"S o \",PRODUCTS);\r\n        const names = contQty(PRODUCTS)\r\n        console.log(\"S o  names \",names);\r\n        const price = contPrice(PRODUCTS)\r\n        console.log(\"S o  price \",price);\r\n        localStorage.setItem(\"orderID\", uuidv4()  );\r\n      \r\n        console.log(\"location : \",location);\r\n        console.log(\"userId : \",userId,token);\r\n        console.log(\"totalPrice : \",totalPrice);\r\n        console.log(\"cartproducts : S o \",cartproducts);\r\n        const ORDERID  =   localStorage.getItem(\"orderID\");\r\n       \r\n        confirmOrders({PRODUCTS,names,cartproducts,price,location,totalPrice,userId,token},userId,token,ORDERID)\r\n        .then((responce)=>{\r\n            console.log(\"resdd . . . \",responce);\r\n            console.log(\"PRODUCTS : \",PRODUCTS);\r\n\r\n            PRODUCTS.map((pName,index)=>{\r\n              console.log(\"pNAme\",pName);\r\n              window.localStorage.removeItem(pName);\r\n              \r\n\r\n            })\r\n            window.localStorage.removeItem(\"cart\");\r\n            window.localStorage.removeItem(\"orderID\");\r\n            setredireact(true)\r\n\r\n        })\r\n        .catch((err)=>{\r\n          console.log(err);\r\n\r\n        })\r\n\r\n\r\n\r\n\r\n    }\r\n    const showTheAddressBar = () => {\r\n\r\n    }\r\n  const isLoading = () => {\r\n    if(loading){\r\n      return (\r\n        <div class=\"spinner-border text-warning\" role=\"status\">\r\n  <span class=\"sr-only\">Loading...</span>\r\n</div>\r\n      )\r\n    }\r\n  }\r\n  const handleLocationError  =(error) => {\r\n    switch(error.code) {\r\n      case error.PERMISSION_DENIED:\r\n        alert(\"User denied the request for Geolocation.\")\r\n        break;\r\n      case error.POSITION_UNAVAILABLE:\r\n        alert(\"Location information is unavailable.\")\r\n        break;\r\n      case error.TIMEOUT:\r\n        alert(\"The request to get user location timed out.\")\r\n        break;\r\n      case error.UNKNOWN_ERROR:\r\n        alert(\"An unknown error occurred.\")\r\n        break;\r\n        default:\r\n          alert(\"An unknown error accurder type ur address manually\");\r\n    }\r\n  }\r\n    const contQty = (product) =>{\r\n      let cart = [];\r\n      let yy = [];\r\n      console.log(\"--->>> y product \",product);\r\n  \r\n      let TOTOAL = 0;\r\n    if (typeof window !== undefined) {\r\n      if (localStorage.getItem(\"cart\")) {\r\n        cart = JSON.parse(localStorage.getItem(\"cart\"));\r\n        product.map((pro,I)=>{\r\n          cart.map((cpor,cI)=>{\r\n              if(cpor!=null &&  pro === cpor.name){\r\n                  TOTOAL = TOTOAL + 1;\r\n              }\r\n          })\r\n          yy.push(TOTOAL)\r\n          TOTOAL=0;\r\n      })\r\n      }\r\n   \r\n    }\r\n   return yy;\r\n          }\r\n    \r\n          \r\n          const contPrice = (product) =>{\r\n            let cart = [];\r\n            let yy = [];\r\n            let curentProduct = [];\r\n            console.log(\"--->>> y product \",product);\r\n        \r\n            let TOTOAL = 0;\r\n          if (typeof window !== undefined) {\r\n            if (localStorage.getItem(\"cart\")) {\r\n              cart = JSON.parse(localStorage.getItem(\"cart\"));\r\n              product.map((pro,I)=>{\r\n                cart.map((cpor,cI)=>{\r\n                    if(cpor!=null &&  pro === cpor.name){\r\n                        TOTOAL = TOTOAL + 1;\r\n                yy.push(cpor.price)\r\n\r\n                    }\r\n                })\r\n                TOTOAL=0;\r\n            })\r\n            }\r\n         \r\n          }\r\n          curentProduct = [...new Set(yy)];\r\n         return curentProduct;\r\n                }\r\n      \r\n\r\nconst shoemap  = () => {\r\n  if(latitude && longitude){\r\n    const loc = {\"latitude\":latitude,\"longitude\":longitude}\r\n    getUserAddress(loc).then(res => {\r\n      // console.log(res);\r\n    })\r\n    .catch(err => {\r\n      // console.log(err);\r\n    })\r\n}\r\n}\r\n    return (\r\n        <div>\r\n            \r\n            <h1>COD</h1>\r\n    <h4>{JSON.stringify(latitude)} {JSON.stringify(longitude)}</h4>\r\n    <div className=\"container\">\r\n  {shoemap()}\r\n    </div>\r\n            <div className=\"container codbox\">\r\n            <div class=\"alert alert-primary\" role=\"alert\">\r\n  We are currently available in<a href=\"#\" class=\"alert-link\"> Malumichampatti</a>. And we can do delivery !!\r\n</div>\r\n            <form>\r\n  <div class=\"form-group\">\r\n    <label>Your Address</label>\r\n    {/* <input placeholder=\"Enter the address\" onChange={(e)=>{locationUser(e)}} type=\"text\" class=\"form-control\" required/> */}\r\n  </div>\r\n      {isRedirectHome()}\r\n    {loadAllUserDatas()}\r\n\r\n      {showUserDelAddres()}\r\n  <button onClick={confirmOrder} type=\"submit\" class=\"btn btn-primary\">Confirm Address</button>\r\n  <button onClick={getGLocation} type=\"submit\" class=\"btn btn-primary\">Confirm Address</button>\r\n\r\n</form>\r\n\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n"]},"metadata":{},"sourceType":"module"}